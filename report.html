<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>高教深耕彙整平台|報告總結管理</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="bower_components/Ionicons/css/ionicons.min.css" rel="stylesheet">
    <link href="bower_components/jvectormap/jquery-jvectormap.css" rel="stylesheet">
    <link href="dist/css/AdminLTE.min.css" rel="stylesheet">
    <link href="dist/css/skins/_all-skins.min.css" rel="stylesheet">
    <link href="bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic"
        rel="stylesheet">
    <style>
        .message {
            border-style: solid;
            border-color: gray;
            margin-left: 20px;
            width: auto;
        }

        .popup {
            border-style: solid;
            border-color: gray;
            width: auto;
        }

        .deletebutton {
            margin-left: 20px;
            margin-top: 10px;
            margin-bottom: 10px;
        }
    </style>
</head>

<body class="hold-transition skin-blue sidebar-mini">
    <form>
        <div class="wrapper">
            <header class="main-header">
                <a class="logo" href="index.html" style="height: 64px"><span class="logo-mini"><b></b></span> <span
                        class="logo-lg"><b>高教深耕彙整平台</b></span></a>
                <nav class="navbar navbar-static-top">
                    <a class="sidebar-toggle" data-toggle="push-menu" href="#" role="button" style="height: 64px;"><span
                            class="sr-only">Toggle navigation</span></a>
                    <div class="navbar-custom-menu">
                        <ul class="nav navbar-nav">
                            <li class="dropdown user user-menu">
                                <a><span class="hidden-xs" id="username" style="font-size:20px">User Name&nbsp;</span>
                                    <span class="hidden-xs" id="usertitle" style="font-size:16px">User
                                        Title&nbsp;</span>
                                    <button class="btn" id="logout_btn" style="color:#707070"
                                        type="button">登出</button></a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </header>
            <aside class="main-sidebar">
                <section class="sidebar">
                    <ul class="sidebar-menu" data-widget="tree" id="menu"></ul>
                </section>
            </aside>
            <div class="content-wrapper" style="min-height: 960px;">
                <br>
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row" style="margin-left:20px;">
                            <a style="font-size: 30px;color: #000000">報告書管理</a> <a
                                style="margin-left:20px;font-size: 24px;color:gray;">執行策略管理</a>
                        </div><br>
                        <div class="row" style="margin-left:20px">
                            <a style="font-size: 24px;color:gray;">年度(民國) :</a> <select id="year">
                            </select> <a style="font-size: 24px;color:gray;">註：預設為今年，年度列表為資料庫裡有資料之年度</a>
                        </div>
                    </div><br>
                </section>
                <section class="content">
                    <div class="container-fluid">
                        <div class="row message">
                            <div style="margin-left:10px">
                                <h1 style="font-size: 20px">執行策略總結列表</h1><br>
                                <div class="box-body">
                                    <table class="table table-bordered table-striped" id="example1"
                                        style="border:1px #000000 solid;">
                                        <thead>
                                            <tr>
                                                <th>策略代號</th>
                                                <th>策略名稱</th>
                                                <th>負責教師</th>
                                                <th>功能</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <div class="modal fade" id="modal-default">
                <div class="modal-dialog" style="width:1000px">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                                    aria-hidden="true">&times;</span></button>
                            <div class="row">
                                <div class="col-sm-6">
                                    <a class="modal-title"
                                        style="color:black;font-size: 30px;margin-left: 20px">報告書管理&nbsp;&nbsp;</a>
                                    <a class="modal-title" style="color:gray;font-size: 24px">執行策略管理</a>
                                </div><br>
                            </div>
                            <div class="row">
                                <div class="col-sm-6">
                                    <a
                                        style="color:gray;font-size: 20px;margin-left: 20px;text-decoration: underline">執行策略總結</a>
                                </div>
                                <div class="col-sm-6" style="text-align:right">
                                    <button class="btn btn-primary btn-sm" data-target="#modal-table"
                                        data-toggle="modal" type="button">活動報告書列表</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal-body">
                            <div class="box-body" style="border-style:solid; border-color:gray">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <p style="margin-bottom:0"><span
                                                style="color:gray;font-size:25px;margin-left: 40px;">教育部指標內容</span></p>
                                        <hr style="margin-top:0">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <p style="margin-bottom:0"><span
                                                style="color:gray;font-size:25px;margin-left: 40px;">執行策略內容</span></p>
                                        <hr style="margin-top:0">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <p style="margin-bottom:0"><span
                                                style="color:gray;font-size:25px;margin-left: 40px;">總結填寫</span></p>
                                        <hr style="margin-top:0">
                                    </div>
                                </div>
                                <div class="row"></div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-default" data-dismiss="modal" type="button">關閉</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="modal-table">
                <div class="modal-dialog" style="width:800px">
                    <div class="modal-content">
                        <div class="modal-header" style="background-color:#5991C9">
                            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                                    aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" style="color:white">詳細資料</h4>
                        </div>
                        <div class="modal-body">
                            <div class="box-body">
                                <table class="table table-bordered table-striped" id="example2">
                                    <thead>
                                        <tr>
                                            <th>報告書名稱(活動或課程名稱)</th>
                                            <th>更新時間</th>
                                            <th>狀態</th>
                                            <th>是否已填寫問卷</th>
                                            <th>活動期限</th>
                                            <th>功能</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td><button class="btn btn-success btn-sm" data-target="#modal-default"
                                                    data-toggle="modal" id='detail' type="button">詳細資訊</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-default" data-dismiss="modal" type="button">關閉</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <script src="bower_components/jquery/dist/jquery.min.js">
    </script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js">
    </script>
    <script src="bower_components/fastclick/lib/fastclick.js">
    </script>
    <script src="dist/js/adminlte.min.js">
    </script>
    <script src="bower_components/jquery-sparkline/dist/jquery.sparkline.min.js">
    </script>
    <script src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js">
    </script>
    <script src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js">
    </script>
    <script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js">
    </script>
    <script src="bower_components/datatables.net/js/jquery.dataTables.min.js">
    </script>
    <script src="bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js">
    </script>
    <script src="dist/js/demo.js">
    </script>
    <script src="dist/js/cookie.js">
    </script>
    <script>
        function detail_fun(sno_option_strategies) {

            var token = GetCookie("token");
            SetCookie("sno_option_strategies", sno_option_strategies, 1, domain);
            document.location.href = 'report2.html';

        }
        var opt = {
            "oLanguage": {
                "sProcessing": "處理中...",
                "sLengthMenu": "顯示 _MENU_ 項結果",
                "sZeroRecords": "沒有匹配結果",
                "sInfo": "顯示第 _START_ 至 _END_ 項結果，共 _TOTAL_ 項",
                "sInfoEmpty": "顯示第 0 至 0 項結果，共 0 項",
                "sInfoFiltered": "(從 _MAX_ 項結果過濾)",
                "sSearch": "搜尋:",
                "oPaginate": {
                    "sFirst": "首頁",
                    "sPrevious": "上一頁",
                    "sNext": "下一頁",
                    "sLast": "尾頁"
                }
            }
        };




        $(document).ready(function () {
            var y = new Date();
            var year_now = y.getFullYear() - 1911;
            console.log(year_now);

            var token = GetCookie("token");
            var user_name = GetCookie("user_name");
            $("#username").text(user_name);
            var usertitle = GetCookie("role_name");
            $('#usertitle').text(usertitle);
            var t = $('#example1').DataTable(opt);
            checkToken();
            $.ajax({
                type: "POST",
                url: "phpMod/menu.php",
                async: false, ///非同步執行
                dataType: "json",
                data: {
                    token: token,
                    page: 3,
                    subpage: 1
                },
                success: function (data) {
                    if (!checkMsg(data.msg)) {
                        delete_all_cookie();
                    }
                    if (checkMsg(data.msg)) {
                        var menu = data.remenu;
                        $("#menu").append(menu);
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                }
            })

            $.ajax({
                type: "POST",
                url: "phpMod/select_project_yyy.php",
                async: false, ///非同步執行
                dataType: "json",
                data: {
                    token: token
                },
                success: function (data) {
                    if (!checkMsg(data.msg)) {
                        delete_all_cookie();
                    }
                    if (checkMsg(data.msg)) {
                        var years = data.out;
                        for (var i = 0; i < years.length; i++) {
                            var o = new Option(years[i], years[i]);
                            $("#year").append(o);
                        }
                        $("#year").val(years[0]);
                    }

                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                }
            });

            var year = $('#year').val();
            $.ajax({
                type: "POST",
                url: "phpMod/summary_get_list.php",
                async: false, ///非同步執行
                dataType: "json",
                data: {
                    token: token,
                    year: year
                },
                success: function (data) {
                    if (!checkMsg(data.msg)) {
                        delete_all_cookie();
                    }
                    if (checkMsg(data.msg)) {
                        for (var i = 0; i < data.out.length; i++) {
                            var data_array = data.out[i];
                            var supervior_name = data_array['supervior_name'];
                            var strategies_name = data_array['strategies_name'];
                            var order = data_array['order'];
                            var sno_option_strategies = data_array['sno_option_strategies'];
                            t.row.add([
                                order,
                                strategies_name,
                                supervior_name,
                                "<button type='button' class='btn bg-olive btn-sm' onClick=detail_fun(this.id) id=" + sno_option_strategies + " value='" + sno_option_strategies + "'>詳細資料<\/button>"
                            ]).draw(false);

                        }


                    }

                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                }
            });
            $("#logout_btn").click(function () {
                $.ajax({
                    type: "POST",
                    url: "phpMod/signout_serve.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token
                    },
                    success: function (data) {

                        if (checkMsg(data.msg)) {

                            delete_all_cookie();
                        }

                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                })
            })

            $('#year').on('change', function () {
                t.clear();
                var year = $('#year').val();

                $.ajax({
                    type: "POST",
                    url: "phpMod/summary_get_list.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token,
                        year: year
                    },
                    success: function (data) {
                        if (!checkMsg(data.msg)) {
                            delete_all_cookie();
                        }
                        if (checkMsg(data.msg)) {
                            for (var i = 0; i < data.out.length; i++) {
                                var data_array = data.out[i];
                                var supervior_name = data_array['supervior_name'];
                                var strategies_name = data_array['strategies_name'];
                                var order = data_array['order'];
                                var sno_edu_indicators_detail = data_array['sno_option_strategies'];
                                t.row.add([
                                    order,
                                    strategies_name,
                                    supervior_name,
                                    "<button type='button' class='btn bg-olive btn-sm' onClick=detail_fun(this.id) id=" + sno_edu_indicators_detail + " value='" + sno_edu_indicators_detail + "'>詳細資料<\/button>"
                                ]).draw(false);

                            }


                        }

                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
            });


        })
    </script>
</body>

</html>