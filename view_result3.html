<!DOCTYPE html>
<html>

<head>
    <script src="dist/js/cookie.js"></script>
    <meta charset="utf-8" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <title>高教深耕彙整平台|成果報告管理</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport" />
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="bower_components/Ionicons/css/ionicons.min.css" rel="stylesheet" />
    <link href="bower_components/jvectormap/jquery-jvectormap.css" rel="stylesheet" />
    <link href="dist/css/AdminLTE.min.css" rel="stylesheet" />
    <link href="dist/css/skins/_all-skins.min.css" rel="stylesheet" />
    <link href="bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic"
        rel="stylesheet" />
    <style>
        .message {
            border-style: solid;
            border-color: gray;
            margin-left: 20px;
        }

        .popup {
            border-style: solid;
            border-color: gray;

            width: auto;
        }

        .deletebutton {
            margin-left: 20px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        @media (max-width: 975px) {
            .message {
                width: auto;
                margin-right: 20px;
            }
        }
    </style>
</head>

<body class="hold-transition skin-blue sidebar-mini">
    <form>
        <div class="wrapper">
            <header class="main-header">
                <a class="logo" href="index.html" style="height: 64px"><span class="logo-mini"><b></b></span> <span
                        class="logo-lg"><b>高教深耕彙整平台</b></span></a>
                <nav class="navbar navbar-static-top">
                    <a class="sidebar-toggle" data-toggle="push-menu" href="#" role="button" style="height: 64px;"><span
                            class="sr-only">Toggle navigation</span></a>
                    <div class="navbar-custom-menu">
                        <ul class="nav navbar-nav">
                            <li class="dropdown user user-menu">
                                <a><span class="hidden-xs" id="username" style="font-size:20px">User Name&nbsp;</span>
                                    <span class="hidden-xs" style="font-size:16px" id="usertitle">User
                                        Title&nbsp;</span>
                                    <button class="btn" id="logout_btn" style="color:#707070" type="button">
                                        登出
                                    </button></a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </header>
            <aside class="main-sidebar">
                <section class="sidebar">
                    <ul class="sidebar-menu" data-widget="tree" id="menu"></ul>
                </section>
            </aside>
            <div class="content-wrapper" style="min-height: 960px;">
                <br />
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row">
                            <a style="font-size: 30px;color: #000000">報告書管理</a>
                            <a style="margin-left:20px;font-size: 24px;color:gray;">成果報告管理</a>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-sm-6">
                                <u style="font-size: 24px;color:gray;">成果報告書-詳細資訊</u>
                            </div>
                            <div class="col-sm-6" style="text-align: right">
                                <button class="btn btn-info btn-sm" data-target="#modal-table" data-toggle="modal"
                                    id="detail" type="button">
                                    審核紀錄
                                </button>
                            </div>
                        </div>
                        <br />
                    </div>
                </section>
                <section class="content">
                    <div class="container-fluid">
                        <div class="row" style="border-style:solid;border-color:gray">
                            <div class="box-body">
                                <div class="row">
                                    <div class="col-sm-12" style="text-align:right">
                                        <a style="color:gray;font-size: 22px">報告書狀態 :</a>
                                        <a id="review_state" style="color:gray;font-size: 22px"></a>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動或課程名稱:</a>
                                    </div>
                                    <div class="col-sm-6"><input disabled id="pname" size="70" type="text" /></div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動執行期限:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled id="estimated_date" size="70" type="text" />
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">主軸/分項/策略名稱:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled id="opt_name" size="70" type="text" />
                                    </div>
                                </div>
                                <!-- <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">部定指標類型:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled id="edu_name" size="70" type="text" />
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">部定指標說明:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled id="edu_detail" size="70" type="text" />
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">部定指標項目:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled id="edusub_name" size="70" type="text" />
                                    </div>
                                </div> -->
                                <br />
                                <div class="row act_date_row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動日期:</a>
                                    </div>
                                    <div class="col-sm-6 act_date"><input disabled type="date" /></div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動地點:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled id="activate_location" size="70" type="text" />
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">參與人數:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled id="paricipant_number" style="width:80%" type="text" />
                                        <span>人</span>
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動經費:</a>

                                    </div>
                                    <div class="col-sm-6"><input disabled id="cost" style="width:80%"
                                            type="text" /><span>元</span></div>

                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">是否依據報部計畫書中甘特圖預定月份執行:</a>
                                    </div>
                                    <div class="col-sm-6" style="padding-top:10px">
                                        <input disabled name="isongante" type="radio" value="1" />是&nbsp;&nbsp;
                                        <input disabled name="isongante" type="radio" value="0" />否
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a id="ininresulf"
                                            style="color:#000000; font-size:18px">是否依據報部計畫書中撰寫之質量化指標執行:</a>
                                    </div>
                                    <div class="col-sm-6" style="padding-top:10px">
                                        <input disabled name="isinresulf" type="radio" value="1" />是&nbsp;&nbsp;
                                        <input disabled name="isinresulf" type="radio" value="0" />否
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動簡述:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <textarea cols="70" disabled id="description" rows="4"></textarea>
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">無法依預定月份執行，請說明原因:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <textarea cols="70" disabled id="reason" rows="4"></textarea>
                                    </div>
                                </div>
                                <br />
                                <div class="row " id="q_row">
                                    <div class="col-sm-3" style="text-align:right">

                                    </div>
                                    <div class="q_col col-sm-9">

                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">是否與其他主軸活動進行成效倍增:</a>
                                    </div>
                                    <div class="col-sm-6" style="padding-top:10px">
                                        <input disabled name="cooperation_project" type="radio"
                                            value="0" />否&nbsp;&nbsp;&nbsp;&nbsp;
                                        <input disabled name="cooperation_project" type="radio"
                                            value="1" />是&nbsp;&nbsp;
                                        <input disabled id="cooperation_project_text" style="width:80%" type="text" />
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">辦理此活動著重之面向:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <input disabled name="target1" type="checkbox"
                                            value="0" />&nbsp;教師面&nbsp;&nbsp;&nbsp;&nbsp;
                                        <input disabled name="target2" type="checkbox"
                                            value="1" />&nbsp;學生面&nbsp;&nbsp;&nbsp;&nbsp;
                                        <input disabled name="target3" type="checkbox"
                                            value="2" />&nbsp;課程面&nbsp;&nbsp;&nbsp;&nbsp;
                                        <input disabled name="target4" type="checkbox"
                                            value="3" />&nbsp;整體面(特色、資源)&nbsp;&nbsp;&nbsp;&nbsp;
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">檢討與建議:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <textarea cols="70" disabled id="recommendations" rows="4"></textarea>
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動簽到:</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <a id="sign_path" style="font-size:18px"></a>
                                    </div>

                                </div>
                                <br />
                                <div class="row img_row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">活動照片:</a>
                                    </div>
                                    <div class="col-sm-6 act_img"></div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-3" style="text-align:right">
                                        <a style="color:#000000; font-size:18px">附件(議程):</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <a id="annex_path" style="font-size:18px"></a>
                                    </div>

                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-6" style="text-align:right">
                                        <button onclick="history.back()" class="btn btn-success" style="width:50%"
                                            type="button">
                                            返回
                                        </button>
                                    </div>
                                    <div class="col-sm-3" style="text-align:right">
                                        <button id="save_btn" class="btn btn-success" style="width:50%" type="button">
                                            儲存
                                        </button></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        <div class="modal fade" id="modal-default">
            <div class="modal-dialog" style="width:1000px">
                <div class="modal-content">
                    <div class="modal-header">
                        <button aria-label="Close" class="close" data-dismiss="modal" type="button">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <div class="row">
                            <div class="col-sm-6">
                                <a class="modal-title"
                                    style="color:black;font-size: 30px;margin-left: 20px">報告書管理&nbsp;&nbsp;</a>
                                <a class="modal-title" style="color:gray;font-size: 24px">執行策略管理</a>
                            </div>
                            <br />
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <a
                                    style="color:gray;font-size: 20px;margin-left: 20px;text-decoration: underline">執行策略總結</a>
                            </div>
                            <div class="col-sm-6" style="text-align:right;max-width: 975;">
                                <button class="btn btn-primary btn-sm" data-target="#modal-table" data-toggle="modal"
                                    type="button">
                                    活動報告書列表
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="modal-body">
                        <div class="box-body" style="border-style:solid; border-color:gray">
                            <div class="row">
                                <div class="col-sm-12">
                                    <p style="margin-bottom:0">
                                        <span style="color:gray;font-size:25px;margin-left: 40px;">教育部指標內容</span>
                                    </p>
                                    <hr style="margin-top:0" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <p style="margin-bottom:0">
                                        <span style="color:gray;font-size:25px;margin-left: 40px;">執行策略內容</span>
                                    </p>
                                    <hr style="margin-top:0" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <p style="margin-bottom:0">
                                        <span style="color:gray;font-size:25px;margin-left: 40px;">總結填寫</span>
                                    </p>
                                    <hr style="margin-top:0" />
                                </div>
                            </div>
                            <div class="row"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-default" data-dismiss="modal" type="button">關閉</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="modal-table">
            <div class="modal-dialog" style="width:1000px">
                <div class="container-fluid">
                    <div class="modal-content">
                        <div class="modal-header" style="background-color:#5991C9">
                            <button aria-label="Close" class="close" data-dismiss="modal" type="button">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title" style="color:white">審核紀錄</h4>
                        </div>
                        <div class="modal-body">
                            <div class="box-body">
                                <div class="row modal_table" id="msgandsummit">
                                    <div class="col-sm-9" style="margin-bottom:2%">
                                        <span style="font-size:24px">建議 :</span>
                                        <input id="recomand" size="80" type="text" />
                                    </div>
                                    <div class="col-sm-3">
                                        <button class="btn btn-primary" id="send_msg" style="margin-top:3%"
                                            type="button">
                                            送出
                                        </button>
                                        <button class="btn btn-warning" id="send_access" style="margin-top:3%"
                                            type="button">
                                            審核通過
                                        </button>
                                    </div>
                                </div>
                                <br />
                                <div class="row" style="border-style:solid;border-color:#707070;">
                                    <div style="margin-left: 2%;margin-right: 2%;margin-top: 2%;margin-bottom: 2%">
                                        <table class="table table-bordered table-striped" id="example2">
                                            <thead>
                                                <tr>
                                                    <th>送件時間</th>
                                                    <th>送件者</th>
                                                    <th>收件者</th>
                                                    <th>額外訊息</th>
                                                    <th>狀態</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-default" data-dismiss="modal" type="button">關閉</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="bower_components/fastclick/lib/fastclick.js"></script>
    <script src="dist/js/adminlte.min.js"></script>
    <script src="bower_components/jquery-sparkline/dist/jquery.sparkline.min.js"></script>
    <script src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
    <script src="bower_components/chart.js/Chart.js"></script>
    <script src="bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <script src="dist/js/demo.js"></script>
    <!-- Include dependencies -->

    <script>
        $("#example2").DataTable({
            paging: true,
            lengthChange: true,
            searching: false,
            ordering: false,
            info: true,
            autoWidth: false,
            oLanguage: {
                sProcessing: "處理中...",
                sLengthMenu: "顯示 _MENU_ 項結果",
                sZeroRecords: "沒有匹配結果",
                sInfo: "顯示第 _START_ 至 _END_ 項結果，共 _TOTAL_ 項",
                sInfoEmpty: "顯示第 0 至 0 項結果，共 0 項",
                sInfoFiltered: "(從 _MAX_ 項結果過濾)",
                sSearch: "搜尋:",
                oPaginate: {
                    sFirst: "首頁",
                    sPrevious: "上一頁",
                    sNext: "下一頁",
                    sLast: "尾頁"
                }
            }
        });

        $(document).ready(function () {
            var opt = {
                oLanguage: {
                    sProcessing: "處理中...",
                    sLengthMenu: "顯示 _MENU_ 項結果",
                    sZeroRecords: "沒有匹配結果",
                    sInfo: "顯示第 _START_ 至 _END_ 項結果，共 _TOTAL_ 項",
                    sInfoEmpty: "顯示第 0 至 0 項結果，共 0 項",
                    sInfoFiltered: "(從 _MAX_ 項結果過濾)",
                    sSearch: "搜尋:",
                    oPaginate: {
                        sFirst: "首頁",
                        sPrevious: "上一頁",
                        sNext: "下一頁",
                        sLast: "尾頁"
                    }
                }
            };

            var token = GetCookie("token");
            var table = $('#example2').DataTable();
            checkToken();
            var pid = GetCookie("pid");
            var t = $("#example1").DataTable(opt);
            var user_name = GetCookie("user_name");
            var role_name = GetCookie("role_name");
            $("#usertitle").text(role_name);
            $("#username").text(user_name);

            $.ajax({
                type: "POST",
                url: "phpMod/menu.php",
                async: false, ///非同步執行
                dataType: "json",
                data: { token: token, page: 6, subpage: 2 },
                success: function (data) {
                    if (checkMsg(data.msg)) {
                        var menu = data.remenu;
                        $("#menu").append(menu);
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                }
            });

            $.ajax({
                type: "POST",
                url: "phpMod/find_paper_detail_serve.php",
                async: false, ///非同步執行
                dataType: "json",
                data: { token: token, pid: pid },
                success: function (data) {
                    if (checkMsg(data.msg)) {
                        console.log(data);
                        $("#review_state").text(data.outt.review_state);
                        var pname = data.outt.pname;
                        $("#pname").val(pname);
                        var estimated_date = data.outt.estimated_date;
                        $("#estimated_date").val(estimated_date);
                        var opt_name = data.outt.opt_name;
                        $("#opt_name").val(opt_name);
                        var edu_name = data.outt.edu_name;
                        $("#edu_name").val(edu_name);
                        var edu_detail = data.outt.edu_detail;
                        $("#edu_detail").val(edu_detail);
                        var edusub_name = data.outt.edusub_name;
                        $("#edusub_name").val(edusub_name);
                        if (data.outt.activate_date != " ") {
                            var activate_date = data.outt.activate_date.split(",");
                            var act_date_length = activate_date.length;
                        } else var act_date_length = activate_date.length;

                        for (var i = 1; i < act_date_length; i++) {
                            $(".act_date_row").after(
                                '<div class="row row2"><div class="col-sm-3" style="text-align:right"><\/div><div class="col-sm-6 act_date" ><input type="date" class="date" disabled><\/div><\/div>'
                            );
                        }
                        $(".act_date")
                            .children("input")
                            .each(function (index) {
                                $(this).val(activate_date[index]);
                            });
                        var activate_location = data.outt.activate_location;
                        $("#activate_location").val(activate_location);
                        var paricipant_number = data.outt.paricipant_number;
                        $("#paricipant_number").val(paricipant_number);
                        var cost = data.outt.cost;
                        $("#cost").val(cost);
                        var isongante = data.outt.isongante;
                        var isinresulf = data.outt.isinresulf;

                        if (isongante == 0)
                            $("input:radio[name=isongante]")
                                .filter("[value=0]")
                                .prop("checked", true);
                        else if (isongante == 1)
                            $("input:radio[name=isongante]")
                                .filter("[value=1]")
                                .prop("checked", true);
                        else {
                            $("input:radio[name=isongante]")
                                .filter("[value=0]")
                                .prop("checked", false);
                            $("input:radio[name=isongante]")
                                .filter("[value=1]")
                                .prop("checked", false);
                        }
                        if (isinresulf == 0)
                            $("input:radio[name=isinresulf]")
                                .filter("[value=0]")
                                .prop("checked", true);
                        else if (isinresulf == 1)
                            $("input:radio[name=isinresulf]")
                                .filter("[value=1]")
                                .prop("checked", true);
                        else {
                            $("input:radio[name=isinresulf]")
                                .filter("[value=0]")
                                .prop("checked", false);
                            $("input:radio[name=isinresulf]")
                                .filter("[value=1]")
                                .prop("checked", false);
                        }
                        var description = data.outt.description;
                        $("#description").val(description);
                        $("#reason").val(data.outt.reason);
                        var results = JSON.parse(data.outt.results);

                        // if (results[0]["qid"] != "") {
                        //     for (var i = 1; i < results.length; i++) {
                        //         $(".q_row").after(
                        //             '<div class="row q_row2">' +
                        //                 '<div class="col-sm-3" style="text-align:right">' +
                        //                 "<\/div>" +
                        //                 '<div class="q_col col-sm-6">' +
                        //                 '<a  class="question" style="color:#000000; font-size:18px" ><\/a>' +
                        //                 "<br>" +
                        //                 '<textarea rows="4" cols="70" class="result" disabled><\/textarea>' +
                        //                 "<\/div><\/div>"
                        //         );
                        //     }
                        //     $(".question").each(function(index) {
                        //         $(this).text(results[index]["question"]);
                        //     });
                        //     $(".result").each(function(index) {
                        //         $(this).val(results[index]["result"]);
                        //     });
                        // } else {
                        //     $(".q_row").hide();
                        // }
                        if (results[0]["qid"] != "") {
                            for (var i = results.length - 1; i >= 0; --i) {
                                console.log(results[i]["type"], results[i]["qid"]);
                                if (results[i]["type"] == 0) {
                                    if (results[i]["result"] == null)
                                        results[i]["result"] = "";
                                    console.log(results[i]);
                                    $("#q_row").after(
                                        '<div class="row q_row2">' +
                                        '<div class="col-sm-3" style="text-align:right">' +
                                        '<a   style="color:#000000; font-size:18px" >管考指標 : <\/a>' +
                                        "<\/div>" +
                                        '<div class="q_col col-sm-6">' +
                                        '<a  class="question" style="color:#000000; font-size:18px" ><\/a></div></div><br/>' +
                                        "<div class='row'><div class='col-sm-3' style='text-align:right'>" +
                                        '<a   style="color:#000000; font-size:18px" >衡量基準 : <\/a>' +
                                        "<\/div>" +
                                        '<div class=" col-sm-6">' +
                                        '<a  class="edu_name2" style="color:#000000; font-size:18px" ><\/a></div></div><br/>' +
                                        "<div class='row'><div class='col-sm-3' style='text-align:right'>" +
                                        '<a   style="color:#000000; font-size:18px" >執行內容 : <\/a></div><div class="col-sm-6"><textarea disabled style="width:100%" rows="4" class="result" id="' + results[i]["qid"] + '">' + results[i]["result"] + '<\/textarea></div></div><br/>'
                                    );
                                } else {
                                    if (results[i]['result'] != null) {
                                        var filepath = results[i]['result'];
                                        var filename = filepath.split('/');
                                        filename = filename[filename.length - 1];
                                        $("#q_row").after(
                                            '<div class="row q_row2">' +
                                            '<div class="col-sm-3" style="text-align:right">' +
                                            '<a   style="color:#000000; font-size:18px" >管考指標 : <\/a>' +
                                            "<\/div>" +
                                            '<div class="q_col col-sm-6">' +
                                            '<a  class="question" style="color:#000000; font-size:18px" ><\/a></div></div><br/>' +
                                            "<div class='row'><div class='col-sm-3' style='text-align:right'>" +
                                            '<a   style="color:#000000; font-size:18px" >衡量基準 : <\/a>' +
                                            "<\/div>" +
                                            '<div class=" col-sm-6">' +
                                            '<a  class="edu_name2" style="color:#000000; font-size:18px" ><\/a></div></div><br/>' +
                                            "<div class='row'><div class='col-sm-3' style='text-align:right'>" +
                                            '<a   style="color:#000000; font-size:18px" >執行內容 : <\/a></div><div class="col-sm-6"><a href="' + filepath +
                                            '">' + filename + '</a></div></div><br/>'

                                        );
                                    } else {
                                        $("#q_row").after(
                                            '<div class="row q_row2">' +
                                            '<div class="col-sm-3" style="text-align:right">' +
                                            '<a   style="color:#000000; font-size:18px" >管考指標 : <\/a>' +
                                            "<\/div>" +
                                            '<div class="q_col col-sm-6">' +
                                            '<a  class="question" style="color:#000000; font-size:18px" ><\/a></div></div><br/>' +
                                            "<div class='row'><div class='col-sm-3' style='text-align:right'>" +
                                            '<a   style="color:#000000; font-size:18px" >衡量基準 : <\/a>' +
                                            "<\/div>" +
                                            '<div class=" col-sm-6">' +
                                            '<a  class="edu_name2" style="color:#000000; font-size:18px" ><\/a></div></div><br/>' +
                                            "<div class='row'><div class='col-sm-3' style='text-align:right'>" +
                                            '<a   style="color:#000000; font-size:18px" >執行內容 : <\/a></div><div class="col-sm-6"><input type="file" name="q' + results[i]["qid"] + '"/></div></div><br/>'

                                        );
                                    }

                                }

                            }
                            $(".question").each(function (index) {
                                $(this).text(results[index]["edu_name2"]);
                            });
                            $(".edu_name2").each(function (index) {
                                $(this).text(results[index]["question"]);
                            })

                        }
                        else {
                            $(".q_row").hide();
                            //results = " ";
                        }


                        var cooperation_project = data.outt.cooperation_project;
                        if (cooperation_project == "") {
                            $("input:radio[name=cooperation_project]")
                                .filter("[value=0]")
                                .prop("checked", true);
                        } else {
                            $("input:radio[name=cooperation_project]")
                                .filter("[value=1]")
                                .prop("checked", true);
                            $("#cooperation_project_text").val(cooperation_project);
                        }
                        var target = data.outt.target;
                        var target_length = data.outt.target.length
                        console.log(data.outt.target.length);
                        for (var i = 0; i < target_length; i++) {
                            if (target[i] == 0)
                                $("input:checkbox[name=target1]")
                                    .filter("[value=0]")
                                    .prop("checked", true);
                            if (target[i] == 1)
                                $("input:checkbox[name=target2]")
                                    .filter("[value=1]")
                                    .prop("checked", true);
                            if (target[i] == 2)
                                $("input:checkbox[name=target3]")
                                    .filter("[value=2]")
                                    .prop("checked", true);
                            if (target[i] == 3)
                                $("input:checkbox[name=target4]")
                                    .filter("[value=3]")
                                    .prop("checked", true);
                        }
                        $("#recommendations").val(data.outt.recommendations);
                        var sign_path = data.outt.sign_path;

                        if (sign_path != null && sign_path != "" && sign_path != undefined) {
                            var sign_name = sign_path.split("/");
                            sign_name = sign_name[sign_name.length - 1];
                        }
                        else
                            var sign_name = "";

                        console.log(sign_name);
                        $("#sign_path").text(sign_name);
                        $("#sign_path").attr("href", sign_path);

                        var annex_path = data.outt.annex_path;
                        if (annex_path != null && annex_path != "" && annex_path != undefined) {
                            var annex_name = annex_path.split("/");
                            annex_name = annex_name[annex_name.length - 1];
                            console.log(annex_name);
                        }
                        else
                            var annex_name = "";

                        $("#annex_path").text(annex_name);
                        $("#annex_path").attr("href", annex_path);


                        var img_arr_length = data.img.length;
                        if (img_arr_length != 0) {
                            for (var i = 0; i < img_arr_length; i++) {
                                $(".img_row").after(
                                    '<div class="row img_row2">' +
                                    '<div class="col-sm-3" style="text-align:right">' +
                                    "<\/div>" +
                                    '<div class="col-sm-9 act_img" >' +
                                    '<table width="80%" height="80%" border="1" ><tbody><tr   align="center"><td  colspan="2"><img  class="img_src" style="padding-top:1%;padding-bottom:1%"></td></tr>' +
                                    '<tr ><td width="50%"><span style="padding-left:2%">圖片說明 : </span></td><td width="50%"><span class="img_dec" style="padding-left:2%"></span></td></tr></tbody></table></div>' +
                                    '<\/div><br>'
                                );
                            }
                            $(".img_src").each(function (index) {
                                $(this).attr("src", data.img[index]["img_path"]);
                            });
                            $(".img_dec").each(function (index) {
                                $(this).text(data.img[index]["img_des"]);
                            });
                        }

                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                }
            });

            $("#logout_btn").click(function () {
                $.ajax({
                    type: "POST",
                    url: "phpMod/signout_serve.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: { token: token },
                    success: function (data) {
                        if (checkMsg(data.msg)) {
                            DelCookie("token", domain);
                            DelCookie("name", domain);
                            document.location.href = "login.html";
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
            });
            $("#save_btn").click(function () {
                document.location.href = "result.html";
            });


            $("#detail").click(function () {
                table.clear();
                $.ajax({
                    type: "POST",
                    url: "phpMod/letter_get_list.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token,
                        sno_option_projects: pid
                    },
                    success: function (data) {
                        if (!checkMsg(data.msg)) {
                            delete_all_cookie();
                        }
                        if (checkMsg(data.msg)) {
                            if (data.issupervisor != 1) {
                                $("#send_access").hide();
                            }
                            for (var i = 0; i < data.out.length; i++) {
                                var data_array = data.out;
                                var created_at = data_array[i]["created_at"];
                                var source = data_array[i]["source"];
                                var exmsg = data_array[i]["exmsg"];
                                var type = data_array[i]["type"];
                                var target = data_array[i]["target"];

                                table.row.add([created_at, source, target, exmsg, type]).draw(false);
                            }
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
            });
            $("#send_project").click(function () {
                $.ajax({
                    type: "POST",
                    url: "phpMod/letter_submit.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token,
                        sno_option_projects: pid
                    },
                    success: function (data) {
                        if (!checkMsg(data.msg)) {
                            delete_all_cookie();
                        }
                        if (checkMsg(data.msg)) {
                            document.location.href = "result.html";
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
            });
            //送出額外訊息
            $("#send_msg").click(function () {
                var message = $("#recomand").val();
                $.ajax({
                    type: "POST",
                    url: "phpMod/letter_record.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token,
                        sno_option_projects: pid,
                        message: message
                    },
                    success: function (data) {
                        if (!checkMsg(data.msg)) {
                            delete_all_cookie();
                        }
                        if (checkMsg(data.msg)) {
                            alert("訊息送出");
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
                table.clear();
                $.ajax({
                    type: "POST",
                    url: "phpMod/letter_get_list.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token,
                        sno_option_projects: pid
                    },
                    success: function (data) {
                        if (!checkMsg(data.msg)) {
                            delete_all_cookie();
                        }
                        if (checkMsg(data.msg)) {
                            if (data.issupervisor != 1) {
                                $("#send_access").hide();
                            }
                            for (var i = 0; i < data.out.length; i++) {
                                var data_array = data.out;
                                var created_at = data_array[i]["created_at"];
                                var source = data_array[i]["source"];
                                var exmsg = data_array[i]["exmsg"];
                                var type = data_array[i]["type"];
                                var target = data_array[i]["target"];

                                table.row.add([created_at, source, target, exmsg, type]).draw(false);
                            }
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
            });

            $("#send_access").click(function () {
                var message = $("#recomand").val();
                $.ajax({
                    type: "POST",
                    url: "phpMod/letter_access.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token,
                        sno_option_projects: pid,
                        message: message
                    },
                    success: function (data) {
                        if (!checkMsg(data.msg)) {
                            delete_all_cookie();
                        }
                        if (checkMsg(data.msg)) {
                            document.location.href = "result.html";
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
                table.clear();
                $.ajax({
                    type: "POST",
                    url: "phpMod/letter_get_list.php",
                    async: false, ///非同步執行
                    dataType: "json",
                    data: {
                        token: token,
                        sno_option_projects: pid
                    },
                    success: function (data) {
                        if (!checkMsg(data.msg)) {
                            delete_all_cookie();
                        }
                        if (checkMsg(data.msg)) {
                            if (data.issupervisor != 1) {
                                $("#send_access").hide();
                            }
                            for (var i = 0; i < data.out.length; i++) {
                                var data_array = data.out;
                                var created_at = data_array[i]["created_at"];
                                var source = data_array[i]["source"];
                                var exmsg = data_array[i]["exmsg"];
                                var type = data_array[i]["type"];
                                var target = data_array[i]["target"];

                                table.row.add([created_at, source, target, exmsg, type]).draw(false);
                            }
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                    }
                });
            });
        });
    </script>
</body>

</html>